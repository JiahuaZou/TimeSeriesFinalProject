---
title: "153projcode"
author: "Zhengyi Sui"
date: "5/4/2019"
output: html_document
---

```{r}
library(ggplot2)
library(astsa)
library(TSA)
library(forecast)
```


```{r}
dat1 <- read.csv("stat153_final_project/data1.csv")
dat1 <- as.ts(dat1$x)
# colnames(dat1) <- c("time", "value")
# value1 <- dat1$value
plot(dat1)
```

1. EDA

```{r}
var_fun <- function(ts,ran){ n <- length(ts)
variances <- c(1:(n-ran))
for (x in variances){
     variances[x] <- var(ts[x:(x+ran)])}
return(variances)
}
plot(var_fun(dat1,50), type='l') #window of 50
deep1 <- log(dat1)
plot(var_fun(sqrt(dat1),50),type='l')
```

```{r}
value_log <- diff(log(dat1))
periodogram(value_log)
```


```{r}
plot(value_log)
```
```{r}
acf2(value_log)
```
```{r}
model1 <-sarima(value_log,1,0,1,1,0,1,12)
model2 <-sarima(value_log,1,0,1,1,0,1,12, no.constant = TRUE)
```
```{r}
print(model1$AIC)
print(model2$AIC)
print(model1$AICc)
print(model2$AICc)
print(model1$BIC)
print(model2$BIC)
```


