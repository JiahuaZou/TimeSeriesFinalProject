---
title: "153projcode"
author: "Zhengyi Sui"
date: "5/4/2019"
output: html_document
---

```{r}
library(ggplot2)
library(astsa)
library(TSA)
```


```{r setup, include=FALSE}
dat1 <- read.csv("stat153_final_project/data1.csv")
colnames(dat1) <- c("time", "value")
value1 <- dat1$value
```

1. EDA
```{r}
summary(dat1)
ggplot(data = dat1) +
  geom_line(aes(x = time, y = value)) +
  geom_point(aes(x = time, y = value), size = 0.7) +
  scale_x_continuous(breaks = seq(0, 180, by = 20)) +
  scale_y_continuous(breaks = seq(0.8, 2.3, by = 0.15)) +
  xlab("time") +
  ylab("value") +
  ggtitle("Original trend of data 1") +
  theme_minimal()
# both log and sqrt doesn't have decent result

value_log <- log(value1)
plot(value_log, type = "l")
plot(diff(value_log), type = "l")

diff1=diff(value_log)
diff2=diff(diff1)

acf(diff2)
pacf(diff2)
# acf(diff1)
# pacf(diff1)

value_sqrt <- sqrt(value1)
plot(value_sqrt, type = "l")
plot(diff(value_sqrt), type = "l")


# try diffence
value_df1 <- diff(value1)
plot(value_df1, type = "l")
value_df1_log <- log(value_df1)
acf2(value_df1)


# mt = filter(value_log, rep(1, 3)/12)
# tme = 1: length(value_log)
# #plot(value_log,type="l")
# plot(tme, mt, type = "l", xlab = "Quarters", ylab = "Gas Consumption", main = "Logarithm of the UK gas consumption data")
# points(tme, mt, type = "l", col = "red")
# 
# acf2(mt)


```

```{r}
period=periodogram(diff1)
spec=sort(period$spec,decreasing = TRUE)
specmax=spec[1:4]
specmax
acf2(diff1)
# model1=sarima(diff1,p=1,d=0,q=1,P=1,D=0,Q=1,S=6)
# model2=sarima(diff1,p=1,d=0,q=1,P=1,D=0,Q=1,S=12)
# model3=sarima(diff1,p=1,d=0,q=1,P=1,D=1,Q=1,S=6)
# model4=sarima(diff1,p=0,d=0,q=1,P=1,D=1,Q=1,S=6)
# model5=sarima(diff1,p=0,d=0,q=1,P=1,D=1,Q=1,S=12)
# model6=sarima(diff1,p=1,d=0,q=1,P=1,D=1,Q=1,S=12)
# model7=sarima(diff1,p=1,d=0,q=0,P=1,D=1,Q=1,S=12)
# model8=sarima(diff1,p=1,d=0,q=0,P=0,D=1,Q=1,S=12)

model1=sarima(value_log,p=1,d=1,q=1,P=1,D=0,Q=1,S=6)
model2=sarima(value_log,p=1,d=1,q=1,P=1,D=0,Q=1,S=12)
model3=sarima(value_log,p=1,d=1,q=1,P=1,D=1,Q=1,S=6)
model4=sarima(value_log,p=0,d=1,q=1,P=1,D=1,Q=1,S=6)
model5=sarima(value_log,p=0,d=1,q=1,P=1,D=1,Q=1,S=12)
model6=sarima(value_log,p=1,d=1,q=1,P=1,D=1,Q=1,S=12)
model7=sarima(value_log,p=1,d=1,q=0,P=1,D=1,Q=1,S=12)
model8=sarima(value_log,p=1,d=1,q=0,P=0,D=1,Q=1,S=12)


model6$ttable
model7$ttable
model8$ttable


predmodel1 <-sarima.for(value_log, 10,1, 0, 0, 1, 1, 1, 12)
predmodel1

aic1=model1$AIC
aic2=model2$AIC
aic3=model3$AIC
aic4=model4$AIC
aic5=model5$AIC
aic6=model6$AIC
aic7=model7$AIC
aic8=model8$AIC
aic1
aic2
aic3
aic4
aic5
aic6
aic7
aic8

bic1=model1$BIC
bic2=model2$BIC
bic3=model3$BIC
bic4=model4$BIC
bic5=model5$BIC
bic6=model6$BIC

bic1
bic2
bic3
bic4
bic5
bic6

head(USArrests)
states <- rownames(USArrests)
head(states)
num_chars <- nchar(states)
num_chars

lord <- c("v", "o", "l", "d", "e", "m", "o", "r", "t")
lord[as.logical(-1:0)]

```

